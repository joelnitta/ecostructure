out <- ecostructure_nullmodel(taxonomic_counts, K=2,
iter_randomized=5, option = "BF")
devtools::document()
library(ecostructure)
devtools::document()
library(ecostructure)
?CountClust:ExtractTopFeatures
?CountClust::ExtractTopFeatures
features <- CountClust::ExtractTopFeatures(australia_model$theta, top_features = 10,
method = "poisson", options = "max")
data("australia_model")
ecostructure_plot_pie(omega = australia_model$omega,
coords = australia_birds$latlong,
long_lim = c(110,160),
lat_lim = c(-50,-10),
path = "geostructure_plot.tiff",
color= c("orange", "red", "yellow", "deepskyblue",
"chartreuse", "blue"))
features <- CountClust::ExtractTopFeatures(australia_model$theta, top_features = 10,
method = "poisson", options = "max")
dim(australia_model$theta)
australia_model$theta
dim(australia_model$omega)
model <- get(load("../methClust-pages/output/Australia/methClust_6.rda"))
dim(model$omega)
dim(model$freq)
dim(australia_model)
dim(australia_model$theta)
australia_model$theta = NULL
names(australia_model)
austalia_model$theta <- model$freq
australia_model$theta <- model$freq
names(australia_model)
dim(australia_model$omega)
dim(australia_model$theta)
devtools::use(australia_model, overwrite = TRUE)
devtools::use_data(australia_model, overwrite = TRUE)
data("australia_model")
ecostructure_plot_pie(omega = australia_model$omega,
coords = australia_birds$latlong,
long_lim = c(110,160),
lat_lim = c(-50,-10),
path = "geostructure_plot.tiff",
color= c("orange", "red", "yellow", "deepskyblue",
"chartreuse", "blue"))
features <- CountClust::ExtractTopFeatures(australia_model$theta, top_features = 10,
method = "poisson", options = "max")
dim(australia_model$theta)
names(australia_model)
names(australia_model)
model <- get(load("../methClust-pages/output/Australia/methClust_6.rda"))
dim(model$freq)
australia_model$theta <- model$freq
dim(australia_model)
dim(australia_model$omega)
dim(australia_model$theta)
names(australia_model)
dim(australia_model)
dim(australia_model$theta)
devtools::use_data(australia_model)
devtools::document()
library(ecostructure)
data("australia_model")
ecostructure_plot_pie(omega = australia_model$omega,
coords = australia_birds$latlong,
long_lim = c(110,160),
lat_lim = c(-50,-10),
path = "geostructure_plot.tiff",
color= c("orange", "red", "yellow", "deepskyblue",
"chartreuse", "blue"))
features <- CountClust::ExtractTopFeatures(australia_model$theta, top_features = 10,
method = "poisson", options = "max")
features
colnames(australia_birds$colnames())
colnames(australia_birds$colnames)
colnames(australia_birds$pr_ab_data)
apply(features$indices, c(1,2), function(x) return(rownames(australia_model$theta)[x]))
features <- CountClust::ExtractTopFeatures(australia_model$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(australia_model$theta)[x]))
east_west_dir <- site_metadata$WorE
elevation_metadata <- site_metadata$Elevation
ecostructure_blocks(fit$omega,
blocker_metadata = east_west_dir,
order_metadata = elevation_metadata)
features <- CountClust::ExtractTopFeatures(fit$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(fit$theta)[x]))
fit <- ecostructure_fit(taxonomic_counts, K = 2, tol = 0.1, num_trials = 10)
east_west_dir <- site_metadata$WorE
elevation_metadata <- site_metadata$Elevation
ecostructure_blocks(fit$omega,
blocker_metadata = east_west_dir,
order_metadata = elevation_metadata)
devtools::document()
library(ecostructure)
devtools::document()
library(ecostructure)
library(methClust)
library(Biobase)
library(rasterVis)
library(gtools)
library(bigalgebra)
help(package = "ecostructure")
devtools::document()
library(ecostructure)
devtools::document()
library(ecostructure)
library(ecostructure)
knitr::opts_chunk$set(dpi = 90,dev = "png")
library(Biobase)
library(ecostructure)
data("himalayan_birds")
species_counts <- t(exprs(himalayan_birds))
species_counts[1:5,1:5]
site_metadata <- pData(phenoData(himalayan_birds))
head(site_metadata)
species_metadata <- pData(featureData(himalayan_birds))
head(species_metadata, 4)
data("australia_birds")
fit <- ecostructure_fit(species_counts, K = 2, tol = 0.000001, num_trials = 10)
east_west_dir <- factor(site_metadata$WorE, levels = c("W", "E"))
elevation_metadata <- site_metadata$Elevation
ecostructure_blocks(fit$omega,
blocker_metadata = east_west_dir,
order_metadata = elevation_metadata)
features <- CountClust::ExtractTopFeatures(fit$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(fit$theta)[x]))
out <- ecostructure_nullmodel(species_counts, K=2, null.model = "richness",
iter_randomized= 10, option = "BF")
data("australia_model")
ecostructure_plot_pie(omega = australia_model$omega,
coords = australia_birds$latlong,
long_lim = c(110,160),
lat_lim = c(-50,-10),
path = "geostructure_plot.tiff",
color= c("orange", "red", "yellow", "deepskyblue",
"chartreuse", "blue"))
features <- CountClust::ExtractTopFeatures(australia_model$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(australia_model$theta)[x]))
local_him_disp <- dispersion_fields_create(local_data = species_counts, gis_data_type = "shp")
data("dispersion_field_ex")
source('~/Documents/ecostructure/R/dispersion_fields_plot.R')
maps <- dispersion_fields_plot(dispersion_field_ex,
scale = "count",
raster_latlim = c(5,50),
raster_longlim = c(50,120))
setwd("~/Downloads")
setwd("~/Documents/ecostructure/R")
tmp <- readRDS("../data/example_theta.rds")
example_theta <- tmp
devtools::use_data(example_theta)
test <- data("example_theta")
devtools::document()
test <- data("example_theta")
source('~/Downloads/dispersion_fields_motif.R')
library(ecostructure)
data("dispersion_field_ex")
source('~/Documents/ecostructure/R/dispersion_fields_plot.R')
maps <- dispersion_fields_plot(dispersion_field_ex,
#'                                scale = "count",
#'                                raster_latlim = c(5,50),
#'                                raster_longlim = c(50,120))
)
source('~/Documents/ecostructure/R/dispersion_fields_plot.R')
maps <- dispersion_fields_plot(dispersion_field_ex,
#'                                scale = "count",
#'                                raster_latlim = c(5,50),
#'                                raster_longlim = c(50,120))
#'
)
source('~/Documents/ecostructure/R/dispersion_fields_plot.R')
)
maps <- dispersion_fields_plot(dispersion_field_ex,
#'                                scale = "count",
#'                                raster_latlim = c(5,50),
#'                                raster_longlim = c(50,120))
#'
)
data("dispersion_field_ex")
maps <- dispersion_fields_plot(dispersion_field_ex,
scale = "percentage",
raster_latlim = c(5,50),
raster_longlim = c(50,120))
data("dispersion_field_ex")
dispersion_field_ex
dim(dispersion_field_ex)
length(dispersion_field_ex)
class(dispersion_field_ex[[1]])
class(dispersion_field_ex[[1]])[[1]]
disp1 <- raster(dispersion_field_ex)
disp1 <- raster::raster(dispersion_field_ex[[1]])
class(disp1)
summary(disp1)
summary(disp1)[5]
raster::summary(disp1)
library(raster)
summary(disp1)
?summary
remove.packages("raster")
summary(disp1)
rm(list=ls())
library(ecostructure)
data("dispersion_field_ex")
data("dispersion_fields_ex")
library(ecostructure)
data("dispersion_field_ex")
class(dispersion_field_ex[[1]])
disp1 <- as.raster(dispersion_field_ex[[1]])
disp1 <- raster::raster(dispersion_field_ex[[1]])
class(disp1)
summary(disp1)
raster::summary
source('~/Documents/ecostructure/R/dispersion_fields_plot.R')
source('~/Documents/ecostructure/R/dispersion_fields_plot.R')
data("dispersion_field_ex")
maps <- dispersion_fields_plot(dispersion_field_ex,
scale = "percentage",
raster_latlim = c(5,50),
raster_longlim = c(50,120))
maps[[1]]
fit <- ecostructure_fit(species_counts, K = 2, tol = 0.000001, num_trials = 10)
library(raster)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(ecostructure)
knitr::opts_chunk$set(dpi = 90,dev = "png")
library(Biobase)
library(ecostructure)
data("himalayan_birds")
species_counts <- t(exprs(himalayan_birds))
species_counts[1:5,1:5]
site_metadata <- pData(phenoData(himalayan_birds))
head(site_metadata)
species_metadata <- pData(featureData(himalayan_birds))
head(species_metadata, 4)
data("australia_birds")
fit <- ecostructure_fit(species_counts, K = 2, tol = 0.000001, num_trials = 10)
east_west_dir <- factor(site_metadata$WorE, levels = c("W", "E"))
elevation_metadata <- site_metadata$Elevation
ecostructure_blocks(fit$omega,
blocker_metadata = east_west_dir,
order_metadata = elevation_metadata)
features <- CountClust::ExtractTopFeatures(fit$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(fit$theta)[x]))
out <- ecostructure_nullmodel(species_counts, K=2, null.model = "richness",
iter_randomized= 10, option = "BF")
data("australia_model")
ecostructure_plot_pie(omega = australia_model$omega,
coords = australia_birds$latlong,
long_lim = c(110,160),
lat_lim = c(-50,-10),
path = "geostructure_plot.tiff",
color= c("orange", "red", "yellow", "deepskyblue",
"chartreuse", "blue"))
features <- CountClust::ExtractTopFeatures(australia_model$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(australia_model$theta)[x]))
dsp_plots <- dispersion_fields_plot(dispersion_field_ex, raster_latlim = c(5, 50), raster_longlim = c(50, 120), scale = "percentage")
dsp_fields_matrix <- dispersion_fields_to_matrix(dispersion_field_ex)
dim(dsp_fields_matrix)
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
dsp_fld_res = 8)
devtools::document()
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
dsp_fld_res = 8)
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
dsp_fld_res = 8)
library(ecostructure)
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
dsp_fld_res = 8)
himalayan_geo_motifs[[1]]
knitr::opts_chunk$set(dpi = 90,dev = "png")
library(Biobase)
library(ecostructure)
data("himalayan_birds")
species_counts <- t(exprs(himalayan_birds))
species_counts[1:5,1:5]
site_metadata <- pData(phenoData(himalayan_birds))
head(site_metadata)
species_metadata <- pData(featureData(himalayan_birds))
head(species_metadata, 4)
data("australia_birds")
fit <- ecostructure_fit(species_counts, K = 2, tol = 0.000001, num_trials = 10)
east_west_dir <- factor(site_metadata$WorE, levels = c("W", "E"))
elevation_metadata <- site_metadata$Elevation
ecostructure_blocks(fit$omega,
blocker_metadata = east_west_dir,
order_metadata = elevation_metadata)
features <- CountClust::ExtractTopFeatures(fit$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(fit$theta)[x]))
out <- ecostructure_nullmodel(species_counts, K=2, null.model = "richness",
iter_randomized= 10, option = "BF")
data("australia_model")
ecostructure_plot_pie(omega = australia_model$omega,
coords = australia_birds$latlong,
long_lim = c(110,160),
lat_lim = c(-50,-10),
path = "geostructure_plot.tiff",
color= c("orange", "red", "yellow", "deepskyblue",
"chartreuse", "blue"))
features <- CountClust::ExtractTopFeatures(australia_model$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(australia_model$theta)[x]))
dsp_plots <- dispersion_fields_plot(dispersion_field_ex, raster_latlim = c(5, 50), raster_longlim = c(50, 120), scale = "percentage")
dsp_fields_matrix <- dispersion_fields_to_matrix(dispersion_field_ex)
dim(dsp_fields_matrix)
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
dsp_fld_res = 8)
himalayan_geo_motifs[[1]]
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
color_ramp = c("black",
"darkseagreen3","orange","red"),
dsp_fld_res = 8)
himalayan_geo_motifs[[1]]
source('~/Documents/ecostructure/R/dispersion_fields_motif.R')
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
color_ramp = c("black",
"darkseagreen3","orange","red"),
dsp_fld_res = 8)
himalayan_geo_motifs[[1]]
devtools::document()
source('~/Documents/ecostructure/R/dispersion_fields_motif.R')
```{r}
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
color_ramp = c("black",
"darkseagreen3","orange","red"),
dsp_fld_res = 8)
himalayan_geo_motifs[[1]]
source('~/Documents/ecostructure/R/dispersion_fields_motif.R')
himalayan_geo_motifs$motif_maps
setwd("~/Documents/ecostructure/R")
disp <- readRDS("../data/dispersion_field_list.rds")
length(disp)
names(disp)
dispersion_field_ex <- disp
devtools::use_data(dispersion_field_ex)
devtools::use_data(dispersion_field_ex, overwrite = TRUE)
devtools::document()
data("dispersion_field_ex")
dsp_plots <- dispersion_fields_plot(dispersion_field_ex, raster_latlim = c(5, 50), raster_longlim = c(50, 120), scale = "percentage")
data("dispersion_field_ex")
dsp_plots <- dispersion_fields_plot(dispersion_field_ex, raster_latlim = c(5, 50), raster_longlim = c(50, 120), scale = "percentage")
```
dsp_plots
dsp_plots[[1]]
data("dispersion_field_ex")
dsp_plots <- dispersion_fields_plot(dispersion_field_ex, raster_latlim = c(5, 50), raster_longlim = c(50, 120), scale = "percentage")
length(dispersion_field_ex)
dim(dispersion_field_ex)
dim(dispersion_field_ex[[1]])
360*560
dsp_plots[[1]]
source('~/Documents/ecostructure/R/dispersion_fields_plot.R')
data("dispersion_field_ex")
dsp_plots <- dispersion_fields_plot(dispersion_field_ex, raster_latlim = c(5, 50), raster_longlim = c(50, 120), scale = "percentage")
dsp_plots[[1]]
source('~/Documents/ecostructure/R/dispersion_fields_plot.R')
dsp_plots[[1]]
source('~/Documents/ecostructure/R/dispersion_fields_plot.R')
dsp_plots <- dispersion_fields_plot(dispersion_field_ex,
raster_latlim = c(5, 50), raster_longlim = c(50, 120), scale = "percentage")
dsp_plots[[1]]
source('~/Documents/ecostructure/R/dispersion_fields_motif.R')
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
color_ramp = c("black",
"darkseagreen3","orange","red"),
dsp_fld_res = 8)
himalayan_geo_motifs$motif_maps
knitr::opts_chunk$set(dpi = 90,dev = "png")
library(Biobase)
library(ecostructure)
data("himalayan_birds")
species_counts <- t(exprs(himalayan_birds))
species_counts[1:5,1:5]
site_metadata <- pData(phenoData(himalayan_birds))
head(site_metadata)
species_metadata <- pData(featureData(himalayan_birds))
head(species_metadata, 4)
data("australia_birds")
fit <- ecostructure_fit(species_counts, K = 2, tol = 0.000001, num_trials = 10)
east_west_dir <- factor(site_metadata$WorE, levels = c("W", "E"))
elevation_metadata <- site_metadata$Elevation
ecostructure_blocks(fit$omega,
blocker_metadata = east_west_dir,
order_metadata = elevation_metadata)
features <- CountClust::ExtractTopFeatures(fit$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(fit$theta)[x]))
out <- ecostructure_nullmodel(species_counts, K=2, null.model = "richness",
iter_randomized= 10, option = "BF")
data("australia_model")
ecostructure_plot_pie(omega = australia_model$omega,
coords = australia_birds$latlong,
long_lim = c(110,160),
lat_lim = c(-50,-10),
path = "geostructure_plot.tiff",
color= c("orange", "red", "yellow", "deepskyblue",
"chartreuse", "blue"))
features <- CountClust::ExtractTopFeatures(australia_model$theta, top_features = 5,
method = "poisson", options = "max")
apply(features$indices, c(1,2), function(x) return(rownames(australia_model$theta)[x]))
data("dispersion_field_ex")
dsp_plots <- dispersion_fields_plot(dispersion_field_ex,
raster_latlim = c(5, 50), raster_longlim = c(50, 120),
scale = "percentage")
dsp_plots[[1]]
dsp_fields_matrix <- dispersion_fields_to_matrix(dispersion_field_ex)
dim(dsp_fields_matrix)
data("example_theta")
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
color_ramp = c("black",
"darkseagreen3","orange","red"),
dsp_fld_res = 8)
himalayan_geo_motifs$motif_maps
install.packages("letsR")
library(letsR)
data("Phyllomedusa")
phy_sf <-sf::st_as_sf(Phyllomedusa)
phy_sf
disp_from_scratch <- dispersion_fields_generate(gdb_object = phy_sf,
raster_resolution = 5,
thresh = 3,
raster_latlim = c(50,10),
raster_longlim = c(-120,100),
species_feature = "binomial")
devtools::document()
disp_from_scratch <- dispersion_fields_generate(gdb_object = phy_sf,
raster_resolution = 5,
thresh = 3,
raster_latlim = c(50,10),
raster_longlim = c(-120,100),
species_feature = "binomial")
disp_from_scratch <- dispersion_fields_generate(gdb_object = phy_sf,
raster_resolution = 5,
thresh = 3,
raster_latlim = c(10,50),
raster_longlim = c(-120,100),
species_feature = "binomial")
?dispersion_fields_generate
st_crs(Phyllomedusa_sf) <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
st_crs(phy_sf) <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
sf::st_crs(phy_sf) <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
disp_from_scratch <- dispersion_fields_generate(gdb_object = phy_sf,
raster_resolution = 5,
thresh = 3,
raster_latlim = c(10,50),
raster_longlim = c(-120,100),
species_feature = "binomial")
disp_from_scratch <- dispersion_fields_generate(gdb_object = phy_sf,
raster_resolution = 1,
thresh = 3,
raster_latlim = c(10,50),
raster_longlim = c(-120,100),
species_feature = "binomial")
counts1 <- read.csv("/Users/kushal/Downloads/Counts_5_18_17.csv")
dim(counts1)
data("himalayan_birds")
exprs <- exprs(himalayan_birds)
dim(exprs)
counts1 <- t(read.csv("/Users/kushal/Downloads/Counts_5_18_17.csv", row.names = 1, header = TRUE))
dim(counts1)
counts1 - exprs
counts1 <- read.csv("/Users/kushal/Downloads/Counts_5_18_17.csv", row.names = 1, header = TRUE)
counts1[1:5,1:5]
exprs[1:5,1:5]
exprs1 <- exprs[,match(colnames(exprs), rownames(counts))]
exprs1[1:5,1:5]
exprs1 <- exprs[,match(colnames(exprs), rownames(counts1))]
exprs1[1:5,1:5]
colnames(exprs)
rownames(counts1)
exprs1 <- exprs[,match(rownames(counts1), colnames(exprs))]
exprs1[1:5,1:5]
counts1[1:5,1:5]
t(counts1)[1:5,1:5]
exprs1[1:5,1:5]
exprs1 - t(counts1)
max(exprs1 - t(counts1))
min(exprs1 - t(counts1))
species_counts <- t(exprs(himalayan_birds))
t(species_counts)[1:10,1:5]
species_counts <- t(exprs(himalayan_birds))
t(species_counts)[1:10,1:10]
data("example_theta")
par(mfrow=c(1,2))
himalayan_geo_motifs <- dispersion_fields_motif(example_theta,
color_ramp = c("black",
"darkseagreen3","orange","red"),
dsp_fld_res = 8)
himalayan_geo_motifs$motif_maps$`1`
devtools::document()
devtools::document()
log(NA)
log(NA/NA)
log((NA+1)/(NA-1))
